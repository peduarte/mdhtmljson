#!/usr/bin/env node

var fs = require('fs');
var request = require('request');
var marked = require('marked');
var argv = require('yargs').argv;


function scrapeReadme(url, output) {
  request(url, function (error, response, html) {
    if (!error && response.statusCode == 200) {
      var parsedResult = {
      	html: marked(response.body)
      };

      fs.writeFile(output + '.json', JSON.stringify(parsedResult, null, 4), function(error){
				if (error) { return console.log('Ooops, we have an error – Are you sure the output directory exists? ' + error); }
	      console.log('Your file is ready – ' + output + '.json');
      });
    }
  });
}

if (argv.url) {
	argv.output = argv.output || './mdhtml';
	scrapeReadme(argv.url, argv.output);
} else {
	console.log('You must pass a url via the --url flag');
}
